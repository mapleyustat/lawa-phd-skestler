<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/strict.dtd">
<html>
<head>
<title>LAWA - Library for Adaptive Wavelet Applications</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link type="text/css" href="../../../default.css" rel=stylesheet>

<script type="text/javascript">
  MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     tex2jax: {
         inlineMath: [ ['$','$']/*, ["\\(","\\)"]*/ ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
         processEscapes: true
     },
     "HTML-CSS": { scale: 100 }
  });
</script>

<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>
<body>
<script type="text/javascript" src="../../../wz_tooltip.js"></script>

<div id="body">
<div id="header">
    <div id="slogan">LAWA <br> L<span class="fade">ibrary for </span>
                               A<span class="fade">daptive </span>
                               W<span class="fade">avelet </span>
                               A<span class="fade">pplications </span>
    <div id="wavelet"><img src="../../../../images/wavelet.png" 
         style="float:right" height="160px" alt="wavelet.png"></div></div>
</div>

<div id="content">
<!--<table width="100%">
<tr>
<td valign="top" id="leftmenu">-->
<div id="leftmenu">
<ul id="menu">
<li class="subtitle">lawa</li>
<li><a href="../../../index.html">home</a></li>
<li><a href="../../../doc/license.html">license</a></li>
<li><a href="../../../doc/roadmap.html">roadmap</a></li>

<li class="subtitle">features</li>
<li><a href="../../../doc/features.html">lawa features</a></li>
<li><a href="../../../doc/highperformance.html">high performance</a></li>
<li><a href="../../../doc/convenientusage.html">convenient usage</a></li>

<li class="subtitle">using lawa</li>
<li><a href="../../../doc/download.html">download</a></li>
<li><a href="../../../lawa/lawa.html">documentation</a></li>
<!--<li><a href="/doc/contributingcode.html">contributing code</a></li>-->
<li><a href="../../../doc/mailinglist.html">mailing list</a></li>
<li><a href="../../../doc/reportingbugs.html">reporting bugs</a></li>

    <li class="subtitle">projects</li>
    <li><a href="../../../doc/projects.html">based on / using lawa</a></li>
</ul>
<!--</td>
<td class="main">-->
</div><div id="main">

<p >
     <a href="../../applications.html">PhD thesis by S.K.</a> - <a href="../../new_eval_scheme/doc/unbounded.html">AWGM on unbounded domains</a> - <a href="applyawgmrealline1d.html">The APPLY-AWGM on the real line</a></p>

<h3 class="doc">
The APPLY-AWGM on the real line</h3>

<p >
     Source file <tt>applications/unbounded_domains/adwav/ghs-adwav-realline-helmholtz1d.cpp</tt></p><p >
     This program implements the \(\textbf{APPLY}\)-AWGM on the real line from Section 3.5.2 using different types of wavelets (biorthogonal, \(L_2\)-orthonormal, special multiwavelets from Chapter 5). It can in particular be used to realize the numerical experiments presented in Section 4.4.3.</p><p >
     Note that this program is only for the following one-dimensional problem: Find \(u \in H^1(\mathbb{R})\) such that</p>\[   -\Delta u + c \cdot u = f, \qquad f \in H^{-1}(\mathbb{R}).\]<p >
     As another important remark, we point out that the constant <tt>JMINOFFSET</tt> in lawa/methods/adaptive/datastructures/index.h needs to be set in a way that \(\text{JMINOFFSET}+j_0 \geq 0\) in order to ensure proper functionality of underlying hash maps. When you change JMINOFFSET, you need to re-compile the library liblawa!!</p><p >
     Moreover, we point out that this program relies on the availability of a rhs-file for the implementation of the routine \(\textbf{RHS}\) from Section 4.4.2. The correct set up of this file can be inferred from the example files within this package. Furthermore, we remark that such files can also be generated by the <a href="simawgmrealline1d.html">simplified AWGM</a>. We provide some examples of such files.</p><p >
     Iterator definitions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;IndexSet&lt;Index1D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_set1d_it;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;Coefficients&lt;Lexicographical,T,Index1D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_coeff1d_it;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;Coefficients&lt;AbsoluteValue,T,Index1D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_coeff1d_abs_it;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Basis definitions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;Basis&lt;T,Primal,R,CDF&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_Basis1D;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;Basis&lt;T,Orthogonal,R,Multi&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_Basis1D;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;Basis&lt;T,Primal,R,SparseMulti&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SparseMW_Basis1D;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     (Adaptive) operator definitions (allowing for storing computed values)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;AdaptiveHelmholtzOperatorOptimized1D&lt;T,Primal,R,CDF&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_MA;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;AdaptiveHelmholtzOperatorOptimized1D&lt;T,Orthogonal,R,Multi&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_MA;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;AdaptiveHelmholtzOperatorOptimized1D&lt;T,Primal,R,SparseMulti&gt;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_MA;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     (Adaptive) preconditioner definitions (allowing for storing computed values)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;DiagonalPreconditionerAdaptiveOperator&lt;T,Index1D, CDF_MA&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_Prec;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;DiagonalPreconditionerAdaptiveOperator&lt;T,Index1D, MW_MA&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_Prec;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;DiagonalPreconditionerAdaptiveOperator&lt;T,Index1D, SparseMW_MA&gt;&nbsp;&nbsp;SparseMW_Prec;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Right-hand side integral definitions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;RHSWithPeaks1D&lt;T, CDF_Basis1D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_RhsIntegral1D;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;RHSWithPeaks1D_WO_XBSpline&lt;T&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_RhsIntegral1D_WO_XBSpline;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;RHSWithPeaks1D&lt;T, MW_Basis1D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_RhsIntegral1D;<br>
<!-- CodeLine     4 --><span style="color:#008000">typedef</span>&nbsp;RHSWithPeaks1D&lt;T, SparseMW_Basis1D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SparseMW_RhsIntegral1D;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Right-hand side definitions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;RHS1D&lt;T, CDF_RhsIntegral1D, CDF_Prec&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_Rhs;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;RHS1D&lt;T, CDF_RhsIntegral1D_WO_XBSpline, CDF_Prec&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_Rhs_WO_XBSpline;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;RHS1D&lt;T, MW_RhsIntegral1D, MW_Prec&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_Rhs;<br>
<!-- CodeLine     4 --><span style="color:#008000">typedef</span>&nbsp;RHS1D&lt;T, SparseMW_RhsIntegral1D, SparseMW_Prec&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SparseMW_Rhs;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Definition of solvers (as for all other definitions before, depending on the wavelet basis). In particular, we need to distinguish between the cases where the minimal level \(j_0 \neq -\infty\) and where we do not have a minimal level.</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index1D, CDF_MA, CDF_Rhs&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_GHS_ADWAV_SOLVER;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index1D, CDF_MA, CDF_Rhs_WO_XBSpline&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_GHS_ADWAV_SOLVER_WO_XBSpline;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index1D, MW_MA, MW_Rhs&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_GHS_ADWAV_SOLVER;<br>
<!-- CodeLine     4 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index1D, SparseMW_MA, SparseMW_Rhs&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_GHS_ADWAV_SOLVER;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Wavelet parameters</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;d=atoi(argv[<span style="color:#c00000">2</span>]);<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;d_=atoi(argv[<span style="color:#c00000">3</span>]);<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;j0;&nbsp;<span style="color:#008000">bool</span>&nbsp;w_XBSpline;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Constant appearing the operator \(-\Delta + c\cdot \textrm{Id}\).</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;T c =&nbsp;<span style="color:#c00000">1.</span>;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Number of reference example and maximum number of AWGM iterations</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;example=atoi(argv[<span style="color:#c00000">5</span>]);<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;NumOfIterations=atoi(argv[<span style="color:#c00000">6</span>]);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Definition of required rhs file name required for \(\textbf{RHS}\). Moreover, we distunguish the case between minimal level \(j_0 \neq -\infty\) and no minimal level</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;stringstream rhsfilename;<br>
<!-- CodeLine     2 --><span style="color:#8080ff">//&nbsp;&nbsp;&nbsp;&nbsp;chdir(&quot;./rhs&quot;);</span><br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#af5f00">if</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(strcmp(argv[<span style="color:#c00000">4</span>],<span style="color:#c00000">&quot;-inf&quot;</span>)==<span style="color:#c00000">0</span>) {<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j0=<span style="color:#c00000">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w_XBSpline=<span style="color:#c00000">false</span>;<br>
<!-- CodeLine     5 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rhsfilename &lt;&lt;&nbsp;<span style="color:#c00000">&quot;rhs/rhs_realline_helmholtz_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">1</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">2</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span><br>
<!-- CodeLine     6 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt; argv[<span style="color:#c00000">3</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">4</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; c &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">5</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;.dat&quot;</span>;<br>
<!-- CodeLine     7 -->&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<!-- CodeLine     8 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#af5f00">else</span>&nbsp;<span style="color:#af5f00">if</span>&nbsp;(strcmp(argv[<span style="color:#c00000">4</span>],<span style="color:#c00000">&quot;best&quot;</span>)==<span style="color:#c00000">0</span>) {<br>
<!-- CodeLine     9 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j0=refsol.getMinimalLevel(d,d_); w_XBSpline=<span style="color:#c00000">true</span>;<br>
<!-- CodeLine    10 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rhsfilename &lt;&lt;&nbsp;<span style="color:#c00000">&quot;rhs/rhs_realline_helmholtz_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">1</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">2</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span><br>
<!-- CodeLine    11 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt; argv[<span style="color:#c00000">3</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; j0 &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; c &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">5</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;.dat&quot;</span>;<br>
<!-- CodeLine    12 -->&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<!-- CodeLine    13 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#af5f00">else</span>&nbsp;{<br>
<!-- CodeLine    14 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j0=atoi(argv[<span style="color:#c00000">4</span>]); w_XBSpline=<span style="color:#c00000">true</span>;<br>
<!-- CodeLine    15 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rhsfilename &lt;&lt;&nbsp;<span style="color:#c00000">&quot;rhs/rhs_realline_helmholtz_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">1</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">2</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span><br>
<!-- CodeLine    16 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt; argv[<span style="color:#c00000">3</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">4</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; c &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">5</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;.dat&quot;</span>;<br>
<!-- CodeLine    17 -->&nbsp;&nbsp;&nbsp;&nbsp;}<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of basis and operators</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_Basis1D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_basis(d,d_,j0);<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_MA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_A(CDF_basis,w_XBSpline,c);<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_Prec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_prec(CDF_A);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of rhs when \(j_0 \neq -\infty\)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_RhsIntegral1D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_rhsintegral1d(CDF_basis, rhsFct, refsol.deltas,&nbsp;<span style="color:#c00000">70</span>);<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_Rhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_F(CDF_rhsintegral1d,CDF_prec);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of the AWGM solver when \(j_0 \neq -\infty\)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_GHS_ADWAV_SOLVER&nbsp;&nbsp;&nbsp;&nbsp;CDF_ghs_adwav_solver(CDF_A, CDF_F,optimizedGrow,assembleMatrix);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Calling the AWGM solver when \(j_0 \neq -\infty\)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u = CDF_ghs_adwav_solver.SOLVE(CDF_F.norm_estimate,&nbsp;<span style="color:#c00000">1e-10</span>,&nbsp;&nbsp;convfilename.str().c_str(),<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NumOfIterations, refsol.H1norm());<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of rhs when \(j_0 = -\infty\)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;J_plus_smooth =&nbsp;<span style="color:#c00000">0</span>, J_minus_smooth =&nbsp;<span style="color:#c00000">0</span>, J_plus_singular =&nbsp;<span style="color:#c00000">0</span>, J_minus_singular =&nbsp;<span style="color:#c00000">0</span>;<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">bool</span>&nbsp;singular_integral=<span style="color:#c00000">false</span>;<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refsol.getRHS_WO_XBSplineParameters(d, d_, left_bound, right_bound,<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J_plus_smooth, J_minus_smooth,<br>
<!-- CodeLine     5 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J_plus_singular, J_minus_singular, singular_integral);<br>
<!-- CodeLine     6 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_RhsIntegral1D_WO_XBSpline&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_rhsintegral1d_WO_XBSpline<br>
<!-- CodeLine     7 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CDF_basis.psi, refsol.rhs, refsol.sing_pts,<br>
<!-- CodeLine     8 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; refsol.deltas, left_bound, right_bound,<br>
<!-- CodeLine     9 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c00000">4.</span>,&nbsp;<span style="color:#c00000">20</span>);<br>
<!-- CodeLine    10 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_Rhs_WO_XBSpline&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDF_F_WO_XBSpline(CDF_rhsintegral1d_WO_XBSpline,<br>
<!-- CodeLine    11 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_prec);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of the AWGM solver when \(j_0 = -\infty\)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDF_GHS_ADWAV_SOLVER_WO_XBSpline&nbsp;&nbsp;&nbsp;&nbsp;CDF_ghs_adwav_solver_WO_XBSpline(CDF_A,CDF_F_WO_XBSpline,optimizedGrow,<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; assembleMatrix);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Calling the AWGM solver when \(j_0 \neq -\infty\)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u = CDF_ghs_adwav_solver_WO_XBSpline.SOLVE(CDF_F_WO_XBSpline.norm_estimate,&nbsp;<span style="color:#c00000">1e-10</span>,<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; convfilename.str().c_str(),<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NumOfIterations, refsol.H1norm());<br>
</span></div><!--code_content-->
</div><!-- code -->
<!--
</td>
</tr>
</table>
-->
</div>

</div>
<div id="page_footer"></div>
</div>

<div id="footer">
Copyright &copy; 2011 <a href="http://lawa.sf.net">Alexander Stippler</a>
</div>
</body>
</html>
