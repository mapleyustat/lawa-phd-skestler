<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/strict.dtd">
<html>
<head>
<title>LAWA - Library for Adaptive Wavelet Applications</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link type="text/css" href="../../../default.css" rel=stylesheet>

<script type="text/javascript">
  MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     tex2jax: {
         inlineMath: [ ['$','$']/*, ["\\(","\\)"]*/ ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
         processEscapes: true
     },
     "HTML-CSS": { scale: 100 }
  });
</script>

<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>
<body>
<script type="text/javascript" src="../../../wz_tooltip.js"></script>

<div id="body">
<div id="header">
    <div id="slogan">LAWA <br> L<span class="fade">ibrary for </span>
                               A<span class="fade">daptive </span>
                               W<span class="fade">avelet </span>
                               A<span class="fade">pplications </span>
    <div id="wavelet"><img src="../../../../images/wavelet.png" 
         style="float:right" height="160px" alt="wavelet.png"></div></div>
</div>

<div id="content">
<!--<table width="100%">
<tr>
<td valign="top" id="leftmenu">-->
<div id="leftmenu">
<ul id="menu">
<li class="subtitle">lawa</li>
<li><a href="../../../index.html">home</a></li>
<li><a href="../../../doc/license.html">license</a></li>
<li><a href="../../../doc/roadmap.html">roadmap</a></li>

<li class="subtitle">features</li>
<li><a href="../../../doc/features.html">lawa features</a></li>
<li><a href="../../../doc/highperformance.html">high performance</a></li>
<li><a href="../../../doc/convenientusage.html">convenient usage</a></li>

<li class="subtitle">using lawa</li>
<li><a href="../../../doc/download.html">download</a></li>
<li><a href="../../../lawa/lawa.html">documentation</a></li>
<!--<li><a href="/doc/contributingcode.html">contributing code</a></li>-->
<li><a href="../../../doc/mailinglist.html">mailing list</a></li>
<li><a href="../../../doc/reportingbugs.html">reporting bugs</a></li>

    <li class="subtitle">projects</li>
    <li><a href="../../../doc/projects.html">based on / using lawa</a></li>
</ul>
<!--</td>
<td class="main">-->
</div><div id="main">

<p >
     <a href="../../applications.html">PhD thesis by S.K.</a> - <a href="../../new_eval_scheme/doc/unbounded.html">AWGM on unbounded domains</a> - <a href="applyawgmrealline2d.html">The APPLY-AWGM on the real line in two dimensions</a></p>

<h3 class="doc">
The APPLY-AWGM on the real line in two dimensions</h3>

<p >
     Source file <tt>applications/unbounded_domains/adwav/ghs-adwav-realline-helmholtz2d.cpp</tt></p><p >
     This program implements the \(\textbf{APPLY}\)-AWGM on \(\mathbb{R}^2\) from Section 3.5.2 using different types of wavelets (biorthogonal, \(L_2\)-orthonormal, special multiwavelets from Chapter 5). It can in particular be used to realize the numerical experiments presented in Section 4.6.4.</p><p >
     Note that this program is only for the following two-dimensional problem: Find \(u \in H^1(\mathbb{R}^2)\) such that</p>\[   -\Delta u + c \cdot u = f, \qquad f \in H^{-1}(\mathbb{R}^2).\]<p >
     As another important remark, we point out that the constant <tt>JMINOFFSET</tt> in lawa/methods/adaptive/datastructures/index.h needs to be set in a way that \(\text{JMINOFFSET}+j_0 \geq 0\) in order to ensure proper functionality of underlying hash maps. When you change JMINOFFSET, you need to re-compile the library liblawa!!</p><p >
     Moreover, we point out that this program relies on the availability of a rhs-file for the implementation of the routine \(\textbf{RHS}\) from Section 4.4.2. The correct set up of this file can be inferred from the example files within this package. Furthermore, we remark that such files can also be generated by the <a href="simawgmrealline2d.html">simplified AWGM</a>. As these files are very large, we only provide one instance of such a file.</p><p >
     Iterator definitions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;IndexSet&lt;Index1D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_set1d_it;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;IndexSet&lt;Index2D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_set2d_it;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;Coefficients&lt;Lexicographical,T,Index1D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_coeff1d_it;<br>
<!-- CodeLine     4 --><span style="color:#008000">typedef</span>&nbsp;Coefficients&lt;Lexicographical,T,Index2D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_coeff2d_it;<br>
<!-- CodeLine     5 --><span style="color:#008000">typedef</span>&nbsp;Coefficients&lt;AbsoluteValue,T,Index1D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_coeff1d_abs_it;<br>
<!-- CodeLine     6 --><span style="color:#008000">typedef</span>&nbsp;Coefficients&lt;AbsoluteValue,T,Index2D&gt;::const_iterator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const_coeff2d_abs_it;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Basis definitions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;Basis&lt;T,Orthogonal,R,Multi&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_Basis1D;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;TensorBasis2D&lt;Adaptive, MW_Basis1D, MW_Basis1D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_Basis2D;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;Basis&lt;T,Primal,R,SparseMulti&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SparseMW_Basis1D;<br>
<!-- CodeLine     4 --><span style="color:#008000">typedef</span>&nbsp;TensorBasis2D&lt;Adaptive, SparseMW_Basis1D,SparseMW_Basis1D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_Basis2D;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Operator definition</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;AdaptiveHelmholtzOperatorOptimized2D&lt;T,Orthogonal,R,Multi,<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Orthogonal,R,Multi&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_MA;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;AdaptiveHelmholtzOperatorOptimized2D&lt;T,Primal,R,SparseMulti,<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Primal,R,SparseMulti&gt;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_MA;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     (Adaptive) preconditioner definition (allowing for storing computed values)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;DiagonalPreconditionerAdaptiveOperator&lt;T,Index2D, MW_MA&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_Prec;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;DiagonalPreconditionerAdaptiveOperator&lt;T,Index2D,SparseMW_MA&gt;&nbsp;&nbsp; SparseMW_Prec;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Righthandsides definitions for separable right-hand sides (\(f(x_1,x_2) = f(x_1) \cdot f(x_2)\)) or sums of such functions</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;SeparableRHS2D&lt;T,MW_Basis2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_SeparableRhsIntegral2D;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;SeparableRHS2D&lt;T,SparseMW_Basis2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_SeparableRhsIntegral2D;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;SumOfTwoRHSIntegrals&lt;T,Index2D,MW_SeparableRhsIntegral2D,<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_SeparableRhsIntegral2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_SumOfSeparableRhsIntegral2D;<br>
<!-- CodeLine     5 --><span style="color:#008000">typedef</span>&nbsp;SumOfTwoRHSIntegrals&lt;T,Index2D,SparseMW_SeparableRhsIntegral2D,<br>
<!-- CodeLine     6 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SparseMW_SeparableRhsIntegral2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SparseMW_SumOfSeparableRhsIntegral2D;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Righthandsides definitions for non-separable right-hand side functions with different quadrature ruls (full and sparse tensor product rules).</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;SmoothRHSWithAlignedSing2D&lt;T, MW_Basis2D, SparseGridGP&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_NonSeparableRhsIntegralSG2D;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;SmoothRHSWithAlignedSing2D&lt;T, SparseMW_Basis2D, SparseGridGP&gt;&nbsp;&nbsp; SparseMW_NonSeparableRhsIntegralSG2D;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Definition of APPLY-AWGM solvers depending on the wavelet basis discretization and the right-hand side type</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index2D, MW_MA, MW_SumOfSeparableRhs&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_GHS_ADWAV_SOLVER_SumofSeparableRhs;<br>
<!-- CodeLine     2 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index2D, SparseMW_MA, SparseMW_SumOfSeparableRhs&gt;&nbsp;&nbsp;SparseMW_GHS_ADWAV_SOLVER_SumofSeparableRhs;<br>
<!-- CodeLine     3 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index2D, MW_MA, MW_NonSeparableRhs2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_GHS_ADWAV_SOLVER_NonSeparableRhs;<br>
<!-- CodeLine     4 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index2D, SparseMW_MA, SparseMW_NonSeparableRhs2D&gt;&nbsp;&nbsp;SparseMW_GHS_ADWAV_SOLVER_NonSeparableRhs;<br>
<!-- CodeLine     5 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index2D, MW_MA, MW_SumOfNonSeparableRhs2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_GHS_ADWAV_SOLVER_SumNonSeparableRhs;<br>
<!-- CodeLine     6 --><span style="color:#008000">typedef</span>&nbsp;GHS_ADWAV&lt;T, Index2D, SparseMW_MA,<br>
<!-- CodeLine     7 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_SumOfNonSeparableRhs2D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SparseMW_GHS_ADWAV_SOLVER_SumNonSeparableRhs;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Wavelet basis parameters</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;d&nbsp;&nbsp; =atoi(argv[<span style="color:#c00000">2</span>]);<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;d_&nbsp;&nbsp;=atoi(argv[<span style="color:#c00000">3</span>]);<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;j0_x=atoi(argv[<span style="color:#c00000">4</span>]);<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;j0_y=atoi(argv[<span style="color:#c00000">5</span>]);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Number of the reference example to be considered</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;example=atoi(argv[<span style="color:#c00000">6</span>]);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Maximum number of iterations of the APPLY-AWGM.</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;NumOfIterations=atoi(argv[<span style="color:#c00000">7</span>]);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     File name for the required rhs file</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;stringstream rhsfilename;<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;rhsfilename &lt;&lt;&nbsp;<span style="color:#c00000">&quot;rhs/rhs_realline_pde2d_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">1</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">2</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">3</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span><br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt; argv[<span style="color:#c00000">4</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span>&nbsp;&lt;&lt; argv[<span style="color:#c00000">5</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_cx_0_cy_0_ay_&quot;</span>&nbsp;&lt;&lt; diffusion_y &lt;&lt;&nbsp;<span style="color:#c00000">&quot;_&quot;</span><br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt; argv[<span style="color:#c00000">6</span>] &lt;&lt;&nbsp;<span style="color:#c00000">&quot;.dat&quot;</span>;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Integration order (to be adjusted in the sequel)</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;order=<span style="color:#c00000">20</span>;<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of wavelet basis and operators</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_Basis1D MW_basis_x(d,j0_x);<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_Basis1D MW_basis_y(d,j0_y);<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_Basis2D MW_basis2d(MW_basis_x,MW_basis_y);<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_MA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_A(MW_basis2d,<span style="color:#c00000">1.</span>);<br>
<!-- CodeLine     5 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_Prec&nbsp;&nbsp;&nbsp;&nbsp;MW_P(MW_A);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Setting up the right-hand side for separable reference solution</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TensorRefSols_PDE_Realline2D&lt;T&gt; refsol;<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refsol.setExample(example,&nbsp;<span style="color:#c00000">1.</span>,<span style="color:#c00000">0.</span>,&nbsp;<span style="color:#c00000">0.</span>,&nbsp;<span style="color:#c00000">1.</span>);<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SeparableFunction2D&lt;T&gt; SepFunc1(refsol.rhs_x, refsol.sing_pts_x,<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refsol.exact_y, refsol.sing_pts_y);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of the APPLY-AWGM solver</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_GHS_ADWAV_SOLVER_SumofSeparableRhs MW_ghs_adwav_solver(MW_A,MW_F,<span style="color:#c00000">true</span>,assemble_matrix);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Calling the APPLY-AWGM solver</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coefficients&lt;Lexicographical,T,Index2D&gt; u;<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u = MW_ghs_adwav_solver.SOLVE(MW_F.norm_estimate,&nbsp;<span style="color:#c00000">1e-16</span>, convfilename.str().c_str(),<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NumOfIterations, refsol.H1norm());<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Setting up the right-hand side for separable reference solution</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000">int</span>&nbsp;order =&nbsp;<span style="color:#c00000">31</span>;<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RefSols_PDE_Realline2D&lt;T&gt; refsol;<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refsol.setExample(<span style="color:#c00000">1</span>,&nbsp;<span style="color:#c00000">1.</span>);<br>
<!-- CodeLine     4 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Function2D&lt;T&gt; Func2d(refsol.rhs, refsol.sing_pts_x, refsol.sing_pts_y);<br>
<!-- CodeLine     5 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_NonSeparableRhsIntegralSG2D MW_rhsintegral2d(MW_basis2d, Func2d, order);<br>
<!-- CodeLine     6 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_NonSeparableRhs2D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MW_F(MW_rhsintegral2d,MW_P);<br>
<!-- CodeLine     7 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_F.readIndexSets(rhsfilename.str().c_str());<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Initialization of the APPLY-AWGM solver</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MW_GHS_ADWAV_SOLVER_NonSeparableRhs MW_ghs_adwav_solver(MW_A,MW_F,<span style="color:#c00000">true</span>,assemble_matrix);<br>
</span></div><!--code_content-->
</div><!-- code -->
<p >
     Calling the APPLY-AWGM solver</p><div class="code">
<div class="code_content"><span class="code_content">
<!-- CodeLine     1 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coefficients&lt;Lexicographical,T,Index2D&gt; u;<br>
<!-- CodeLine     2 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u = MW_ghs_adwav_solver.SOLVE(MW_F.norm_estimate,&nbsp;<span style="color:#c00000">1e-16</span>, convfilename.str().c_str(),<br>
<!-- CodeLine     3 -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NumOfIterations, refsol.H1norm());<br>
</span></div><!--code_content-->
</div><!-- code -->
<!--
</td>
</tr>
</table>
-->
</div>

</div>
<div id="page_footer"></div>
</div>

<div id="footer">
Copyright &copy; 2011 <a href="http://lawa.sf.net">Alexander Stippler</a>
</div>
</body>
</html>
